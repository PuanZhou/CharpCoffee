#pragma checksum "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "d13d1cbb101cba05231a7dacf0c6bbc9240ef416"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Home__CommentBoard), @"mvc.1.0.view", @"/Views/Home/_CommentBoard.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\_ViewImports.cshtml"
using prjProduct_core;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\_ViewImports.cshtml"
using prjProduct_core.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
using prjProduct_core.ViewModels;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"d13d1cbb101cba05231a7dacf0c6bbc9240ef416", @"/Views/Home/_CommentBoard.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"7e68a38f904a3c0064916e4a245f427c24105a01", @"/Views/_ViewImports.cshtml")]
    public class Views_Home__CommentBoard : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<IEnumerable<CCommentsViewModel>>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\r\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css\">\r\n\r\n<hr />\r\n    <h4 class=\"display-4\">評論與回覆</h4>\r\n<div>\r\n");
#nullable restore
#line 9 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        //=====================印出所有評論(parent)=====================
        List<CCommentsViewModel> list1 = Model.Where(x => x.CommentParentId == 0).ToList();
        foreach (var item1 in list1)
        {
            LoadComments(item1, CountChildren(item1));

#line default
#line hidden
#nullable disable
            WriteLiteral("            <hr />\r\n");
#nullable restore
#line 15 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }
        //=====================找出子回覆及數量(done by CountChildren())============
        void findChildComments(CCommentsViewModel item1)
        {

#line default
#line hidden
#nullable disable
            WriteLiteral(" <div");
            BeginWriteAttribute("id", " id=\"", 687, "\"", 710, 2);
            WriteAttributeValue("", 692, "d_", 692, 2, true);
#nullable restore
#line 18 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 694, item1.CommentId, 694, 16, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(">\r\n");
#nullable restore
#line 19 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                  List<CCommentsViewModel> list2 = Model.Where(y => y.CommentParentId == item1.CommentId).ToList(); ;
                    foreach (var item2 in list2)
                    {
                        LoadComments(item2, CountChildren(item2));
                    }
                

#line default
#line hidden
#nullable disable
            WriteLiteral("            </div>\r\n");
#nullable restore
#line 26 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }
        //=====================計算子回覆數量=====================
        int CountChildren(CCommentsViewModel item)
        {
            return Model.Count(x => x.CommentParentId == item.CommentId);
        }
        //=====================印出評價或回覆=====================
        void LoadComments(CCommentsViewModel item, int count)
        {

#line default
#line hidden
#nullable disable
            WriteLiteral("<div class=\"m-3 ml-4\">\r\n");
#nullable restore
#line 36 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
       if (item.CommentId == @Model.FirstOrDefault().CommentId)
        {

#line default
#line hidden
#nullable disable
            WriteLiteral("            <small class=\"text-danger\">New</small>\r\n            <span class=\"font-bold\">");
#nullable restore
#line 39 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                               Write(item.MemberName);

#line default
#line hidden
#nullable disable
            WriteLiteral(" &nbsp;：</span>\r\n");
#nullable restore
#line 40 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }
        else
        {

#line default
#line hidden
#nullable disable
            WriteLiteral("            <span class=\"font-bold\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
#nullable restore
#line 43 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                                                                               Write(item.MemberName);

#line default
#line hidden
#nullable disable
            WriteLiteral(" &nbsp;：</span>\r\n");
#nullable restore
#line 44 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }

#line default
#line hidden
#nullable disable
            WriteLiteral("    <span>");
#nullable restore
#line 47 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
     Write(item.CommentDescription);

#line default
#line hidden
#nullable disable
            WriteLiteral(" &nbsp;/&nbsp; </span>\r\n");
#nullable restore
#line 48 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
      
        if (item.Star != null || item.Star > 0)
        {

#line default
#line hidden
#nullable disable
            WriteLiteral("            <span>購入後評價：</span>\r\n");
#nullable restore
#line 52 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
            for (int i = 0; i < item.Star; i++)
            {

#line default
#line hidden
#nullable disable
            WriteLiteral("                <i style=\"color: #CCCCFF\" class=\"bi bi-star-fill\"></i>\r\n");
#nullable restore
#line 55 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
            }

#line default
#line hidden
#nullable disable
            WriteLiteral("            <span>&nbsp;/&nbsp;&nbsp;&nbsp;</span>\r\n");
#nullable restore
#line 57 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }
    

#line default
#line hidden
#nullable disable
#nullable restore
#line 59 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
      
        if (count != 0)
        {

#line default
#line hidden
#nullable disable
            WriteLiteral("<small style=\"cursor:pointer\" class=\"text-warning\"");
            BeginWriteAttribute("onclick", " onclick=\"", 2349, "\"", 2383, 3);
            WriteAttributeValue("", 2359, "showDiv(", 2359, 8, true);
#nullable restore
#line 61 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 2367, item.CommentId, 2367, 15, false);

#line default
#line hidden
#nullable disable
            WriteAttributeValue("", 2382, ")", 2382, 1, true);
            EndWriteAttribute();
            WriteLiteral(">隱藏");
#nullable restore
#line 61 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                                                                                             Write(count);

#line default
#line hidden
#nullable disable
            WriteLiteral("則回覆</small>");
#nullable restore
#line 61 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                                                                                                                    }
        else
        {
            {

#line default
#line hidden
#nullable disable
            WriteLiteral("<small class=\"text-black-50 text-sm\">(尚無回覆)</small>");
#nullable restore
#line 64 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                                                                }
        };

#line default
#line hidden
#nullable disable
            WriteLiteral("        <i style=\"font-size:x-large;cursor:pointer\"");
            BeginWriteAttribute("id", " id=\"", 2564, "\"", 2586, 2);
            WriteAttributeValue("", 2569, "r_", 2569, 2, true);
#nullable restore
#line 66 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 2571, item.CommentId, 2571, 15, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" class=\"bi bi-reply-fill text-success\"></i>\r\n        <div>\r\n            <span");
            BeginWriteAttribute("id", " id=\"", 2664, "\"", 2686, 2);
            WriteAttributeValue("", 2669, "s_", 2669, 2, true);
#nullable restore
#line 68 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 2671, item.CommentId, 2671, 15, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" hidden=\"hidden\">回覆：</span>\r\n            <input");
            BeginWriteAttribute("id", " id=\"", 2734, "\"", 2756, 2);
            WriteAttributeValue("", 2739, "t_", 2739, 2, true);
#nullable restore
#line 69 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 2741, item.CommentId, 2741, 15, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" type=\"text\" name=\"txtReply\" style=\"width:70%\" hidden=\"hidden\" />\r\n            <button");
            BeginWriteAttribute("id", " id=\"", 2843, "\"", 2865, 2);
            WriteAttributeValue("", 2848, "b_", 2848, 2, true);
#nullable restore
#line 70 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
WriteAttributeValue("", 2850, item.CommentId, 2850, 15, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" class=\"btn btn-success btn-sm btnReply\" hidden=\"hidden\">送出回覆</button>\r\n        </div>\r\n");
#nullable restore
#line 72 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        findChildComments(item);
    

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n");
#nullable restore
#line 75 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
        }
    

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n\r\n<script>\r\n    //=====================送出回覆，刷新該欄(callback)=====================\r\n    $(\".btnReply\").click(function () {\r\n        let cpId = $(event.target).attr(\"id\").substr(2);\r\n        let prId = ");
#nullable restore
#line 83 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
               Write(Model.Take(1).Select(x => x.ProductId).FirstOrDefault());

#line default
#line hidden
#nullable disable
            WriteLiteral(";\r\n        let txtReply = $(`#t_${cpId}`).val();\r\n        $.post(\'");
#nullable restore
#line 85 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
           Write(Url.Content("~/api/AddComment"));

#line default
#line hidden
#nullable disable
            WriteLiteral("\', {\r\n            \"OrderId\": 1, \"ProductId\": prId, \"MemberId\": 1, \"CommentParentId\": cpId,\r\n            \"CommentDescription\": txtReply, \"Star\": 0\r\n            }, function () {\r\n            $(\"#divComment\").load(\'");
#nullable restore
#line 89 "D:\iii\期末專題\product(改版後)7.13\slnProduct_core\prjProduct_core\Views\Home\_CommentBoard.cshtml"
                              Write(Url.Content("~/home/_CommentBoard"));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"', { ""productId"": prId });
            })
        })
    //=====================顯示/隱藏回覆的輸入欄等=====================
    $("".bi-reply-fill"").click(function () {
        let cId = $(event.target).attr(""id"").substr(2);
        if ($(`#s_${cId}`).attr(""hidden"") == ""hidden"") {
            $(`#s_${cId}`).removeAttr(""hidden"");
            $(`#t_${cId}`).removeAttr(""hidden"");
            $(`#b_${cId}`).removeAttr(""hidden"");
        }
        else {
            $(`#s_${cId}`).attr(""hidden"", ""hidden"");
            $(`#t_${cId}`).attr(""hidden"", ""hidden"");
            $(`#b_${cId}`).attr(""hidden"", ""hidden"");
        }
    })
    //=====================顯示/隱藏回覆的內文=====================
    function showDiv(divId){
        let d = document.querySelector(`#d_${divId}`);
        let e = event.target;
        let c = e.innerText.substr(2,1)
        if (d.hasAttribute('hidden')) {
            d.removeAttribute('hidden');
            e.setAttribute(""class"",""text-warning"")
            e.innerText=`隱藏${c}則回覆`");
            WriteLiteral(";\r\n            return;\r\n        } else\r\n            d.setAttribute(\'hidden\', \"\");\r\n            e.setAttribute(\"class\", \"text-primary\")\r\n            e.innerText = `查看${c}則回覆`;\r\n            return;\r\n    }\r\n</script>\r\n");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<IEnumerable<CCommentsViewModel>> Html { get; private set; }
    }
}
#pragma warning restore 1591
